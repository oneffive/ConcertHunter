# Техническое задание на проект: ConcertHunter

## 1. Название и концепция
**Тема проекта:** Агрегатор концертных анонсов для любителей музыки с целью покупки билетов в определённом городе.

**Цель проекта:**
Разработка веб-сервиса, автоматизирующего поиск культурных мероприятий. Сервис решает проблему ручного мониторинга афиш на разных сайтах. Пользователь формирует персональный список отслеживания (Артист + Город), а система самостоятельно опрашивает внешний API, нормализует названия локаций и уведомляет о появлении билетов, визуализируя события на интерактивной карте.

## 2. Целевая аудитория и роли пользователей
**Целевая аудитория:**
активные посетители концертов, фанаты музыкальных групп и «музыкальные туристы», планирующие поездки на выступления любимых артистов в другие города и страны.

**Роли пользователей:**
1.  **Гость:**
    *   Просмотр приветственной страницы.
    *   Демонстрационный поиск артистов через глобальную базу (без возможности сохранения).
    *   Регистрация (`Sign Up`) и авторизация (`Login`).
2.  **Зарегистрированный пользователь:**
    *   Ведение списка отслеживания (`Subscription`): добавление и удаление подписок.
    *   Просмотр персональной ленты событий (Dashboard).
    *   Использование интерактивной карты для визуализации географии концертов.
3.  **Администратор:**
    *   Управление пользователями через Django Admin.
    *   Запуск фоновой команды для обновления базы данных событий.
    *   Модерация контента (удаление некорректных событий).

## 3. Схема данных (Сущности)
В проекте реализованы 3 кастомные модели со сложными связями:

### Модель 1: Artist (Исполнитель)
Справочник для кэширования данных об артистах, чтобы минимизировать запросы к API.
*   **name** (CharField): имя исполнителя (например, "Rammstein").
*   **tm_id** (CharField, unique): уникальный ID в системе Ticketmaster.
*   **image_url** (URLField): ссылка на официальное изображение.

### Модель 2: Subscription (Подписка)
Ключевая сущность, связывающая пользователя с объектом наблюдения.
*   **user** (ForeignKey): ссылка на пользователя (User).
*   **artist** (ForeignKey): ссылка на модель Artist.
*   **city** (CharField): локация для мониторинга (Город, например "Istanbul").
*   **is_active** (BooleanField): статус активности подписки.

### Модель 3: Event (Событие)
Найденный концерт, привязанный к артисту.
*   **artist** (ForeignKey): исполнитель.
*   **name** (CharField): название тура/концерта.
*   **date** (DateTimeField): дата и время начала.
*   **venue_name** (CharField): площадка проведения.
*   **city** (CharField): город проведения (нормализованный).
*   **latitude / longitude** (FloatFields): географические координаты для отображения на карте.
*   **ticket_url** (URLField): прямая ссылка на покупку билета.
*   **tm_event_id** (CharField, unique): ID события во внешней системе (защита от дублей).
  
  <img width="506" height="744" alt="Снимок экрана 2026-01-19 145008" src="https://github.com/user-attachments/assets/621f524d-ad97-4099-92be-d65fd0bf4537" />


## 4. Ключевой функционал (User Stories)

1.  **Интеллектуальный поиск и подписка:**
   
    Пользователь ищет артиста через API. При оформлении подписки вводит название города на любом языке (например, "Стамбул"). Система автоматически переводит и нормализует название города (в "Istanbul") с помощью библиотеки `deep-translator` для корректного поиска в международной базе.
2.  **Автоматическая агрегация данных:**

    Реализована кастомная management-команда (`python manage.py update_events`). Скрипт перебирает активные подписки, делает запросы к API, фильтрует прошедшие события, исключает дубликаты и сохраняет новые концерты в БД.
3.  **Личный кабинет и карта:**

    На главной странице пользователь видит список предстоящих концертов только по своим подпискам. Реализована интеграция с JS-библиотекой **Leaflet**: координаты событий передаются с бэкенда в шаблон, где рендерится интерактивная карта с маркерами.
4.  **Управление подписками:**

    Пользователь видит список своих активных подписок и может удалить любую из них. При удалении подписки исчезают и соответствующие маркеры с карты.
## 5. Технический стек и интеграции

*   **Backend:** Python 3.x, Django 5.x.
*   **Внешний API:** **Ticketmaster Discovery API** (поиск артистов, событий, получение геоданных и фото).
*   **Библиотеки анализа/обработки:**
    *   `requests`: взаимодействие с внешним API.
    *   `deep-translator` + `unicodedata`: нормализация и транслитерация названий городов (обработка кейсов с диакритикой, например "İstanbul" -> "Istanbul").
*   **Frontend:**
    *   **Bootstrap 5:** адаптивная верстка, модальные окна, карточки.
    *   **Leaflet.js:** визуализация геоданных (карты).
*   **Безопасность:** хранение ключей API в переменных окружения (`.env`), защита от CSRF, декораторы `@login_required`.
*   **Деплой:** проект развернут на хостинге **PythonAnywhere**.
  
## 6. Изменения и улучшения в ходе реализации

В процессе разработки базовый функционал был расширен для улучшения пользовательского опыта:

1.  **Модуль «Афиша города»:**
  
    *Изначально:* планировался поиск только конкретных артистов.
    
    *Реализовано:* добавлен функционал поиска общих мероприятий в городе. Если у отслеживаемого артиста нет концертов, пользователь может перейти к общей афише, отфильтровать события по жанрам и датам. Это повышает ценность сервиса для музыкального туризма.

2.  **Улучшенная система обновлений:**
  
    *Изначально:* планировалось обновление данных только через фоновый скрипт (`management command`).
    
    *Реализовано:* внедрена система мгновенного обновления. При создании подписки система сразу делает запрос к API, не дожидаясь запуска планового скрипта, чтобы пользователь мгновенно увидел результат. Фоновый скрипт оставлен для регулярной актуализации данных.

3.  **Точечное управление лентой:**
  
      *Реализовано:* добавлена возможность удалять конкретные карточки событий (а не только всю подписку целиком), если пользователь не заинтересован в посещении конкретного концерта.
   
